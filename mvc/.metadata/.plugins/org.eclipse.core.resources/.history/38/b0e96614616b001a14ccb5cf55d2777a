package com.yj.homework.controller;

import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.yj.homework.model.Result;
import com.yj.homework.model.Task;

@RestController
@RequestMapping(value = "/api/tasks")
public class TaskController {

	//通过map模拟数据库中的task表
    static Map<Long, Task> tasks = Collections.synchronizedMap(new HashMap<Long, Task>());
    
	/**
	 * 查询所有task
	 * @return
	 */
	@GetMapping("/")
	public Result getAllTask() {
		List<Task> taskList = (List<Task>) tasks.values();
		if(taskList != null && taskList.size()>0) {
			return Result.build(200, "success", taskList);
		}else {
			return Result.build(200, "there is no task", null);
		}
    }

	
	/**
	 * 根据id查询task
	 * @param id 任务id
	 * @return
	 */
//	@GetMapping("/{id}")
//	public Result getTaskById(@PathVariable Long id) {
//		Task task = taskService.selectTaskById(id);
//		if(task == null) {
//			return Result.build(200, "task don't exist", null);
//		}else {
//			return Result.build(200, "success", task);
//		}
//    }
	
	
	/**
	 * 创建新任务
	 * @param content 任务内容（数据库自增长生成任务id，创建时间在service中生成）
	 * @return
	 * @throws Exception
	 */
//	@PostMapping(value = "/",consumes = "application/json")
//	public Result createTask(@RequestParam String content) throws Exception {
//		content = new String(content.getBytes(),"utf-8");
//		return taskService.createTask(content);
//	}
}
